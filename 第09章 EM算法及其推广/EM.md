## **Expectation Maximization**



### 似然函数

**定义**：
似然函数（Likelihood Function）是一个关于模型参数的函数，用来表示在给定参数下，观测数据出现的概率。它记作 $L(\theta) $或 $P(Y|\theta)$（这里 Y 表示观测数据，$\theta $表示模型参数）。

**关键点**：

- **作为参数的函数**：虽然形式上看起来像一个条件概率，但在似然函数中，数据 Y是固定的，而 θ 是变量。换句话说，我们通过调整 θ 来“解释”观测数据的产生过程。
- **极大似然估计（MLE）**：常见的目标是找到使似然函数最大的参数，即$\hat{\theta} = $$\arg\max_\theta L(\theta)$ 或者等价地，极大化对数似然函数$\hat{\theta} = \arg\max_\theta \log L(\theta)$这种方法称为极大似然估计。

###  **联合概率与边际概率**

####   联合概率 P(Y,Z∣θ)

- 表示观测数据 Y和隐变量 Z同时发生的概率。
- 它是关于 Y和 Z的联合分布。

####   边际概率 P(Y∣θ)

- 表示只与观测数据 Y有关的概率。
- 它是通过将联合概率 P(Y,Z∣θ) 对隐变量 Z进行边际化得到的。

如果隐变量 Z是离散的，边际化通过对 Z的所有可能取值求和来实现：
$$
P(Y \mid \theta) = \sum_{Z} P(Y, Z \mid \theta)
$$
如果隐变量 Z 是连续的，边际化通过对 Z进行积分来实现：
$$
P(Y \mid \theta) = \int_{Z} P(Y, Z \mid \theta) \, dZ
$$

#### **例子：抛硬币实验**

假设现在有两枚硬币1和2，,随机抛掷后正面朝上概率分别为$P_1$,$P_2$

为了估计这两个概率，做实验，每次取一枚硬币，连掷5下，记录下结果，如下:

![image-20250219183459235](C:\Users\AmTo2\AppData\Roaming\Typora\typora-user-images\image-20250219183459235.png)

可以很容易地得出$P_1$=0.4  ,$P_2$=0.5

![image-20250219183624985](C:\Users\AmTo2\AppData\Roaming\Typora\typora-user-images\image-20250219183624985.png)

先假设P1=0.2， P2=0.7

  若是硬币1: 0.2  *  0.2  * 0.8  *  0.2  *  0.8=0.00512

  若是硬币2:0.7  *  0.7  *0.3  *  0.3  *  0.7 = 0.03087

![image-20250219184152940](C:\Users\AmTo2\AppData\Roaming\Typora\typora-user-images\image-20250219184152940.png)

按照最大似然法则：
第1轮中最有可能的是**硬币2**

我们就把上面的值作为z的估计值。然后按照最大似然概率法则来估计新的P1   P2 
$$
P_1=(2+1+2)/15=0.33
$$

$$
P_2=(3+3)/10=0.6
$$

估计的P1 P2 相比于他们的初始值，更接近于他们的真实值了

上面的方法还有没有改进的余地？

  我们是用最大似然概率法则估计出的z值，然后再用z值按照最大似然概率法则估计新的P1，P2

我们使用了一个最可能的z值，而不是所有可能的z 值 ，可以用期望来简化运算，

 第一轮是硬币1的期望：0.00512/(0.00512+0.03807)=0.14

  是硬币2的期望：0.86

![image-20250219190332727](C:\Users\AmTo2\AppData\Roaming\Typora\typora-user-images\image-20250219190332727.png)

这一步，我们实际上是估计出了z的概率分布，这步被称作`E步`

以P1 为例第一轮相当于 0.14的概率是硬币1  第一轮：0.14* 3  =0.42正  0.14 * 2 =0.28反



![image-20250219190933130](C:\Users\AmTo2\AppData\Roaming\Typora\typora-user-images\image-20250219190933130.png)

P1=4.22/(4.22+7.98)=0.35

这步中，我们根据E步中求出的z的概率分布，依据最大似然概率法则去估计P1 P2 ，称作M步
